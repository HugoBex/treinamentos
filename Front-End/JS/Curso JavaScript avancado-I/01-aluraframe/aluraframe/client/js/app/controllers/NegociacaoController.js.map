{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","Negociacao","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputvalor","_listaNegociacoes","_mensagem","_ordemAtual","_init","_listarTodos","setInterval","importarNegociacoes","apagar","then","texto","mensagem","removerTodosRegistros","_limparCamposForm","catch","erroMsg","event","preventDefault","negociacao","_criaNegociacao","cadastrar","adiciona","msg","erro","listar","adicionarTodos","negociacoes","textToDate","value","parseInt","parseFloat","focus","service","importar","forEach","coluna","inverteOrdem","ordena","a","b","current","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import { ListaNegociacoes } from '../models/ListaNegociacoes';\nimport { Mensagem } from '../models/Mensagem';\nimport { NegociacoesView } from '../views/NegociacoesView';\nimport { MensagemView } from '../views/MensagemView';\nimport { NegociacaoService } from '../services/NegociacaoService';\nimport { DateHelper } from '../helpers/DateHelper';\nimport { Bind } from '../helpers/Bind';\nimport { Negociacao } from '../models/Negociacao';\n\n\nclass NegociacaoController {\n\n    constructor() {\n        let $ = document.querySelector.bind(document);\n        this._inputData = $('#data');\n        this._inputQuantidade = $('#quantidade');\n        this._inputvalor = $('#valor');\n\n        this._listaNegociacoes = new Bind(new ListaNegociacoes(),\n            new NegociacoesView($('#tabelaNegociacoes')),\n            'adiciona', 'removerTodosRegistros',\n            'ordena', 'inverteOrdem', 'adicionarTodos');\n\n        this._mensagem = new Bind(new Mensagem(''), new MensagemView($('#mensagem')), 'texto');\n        this._ordemAtual = '';\n        this._init();\n\n    }\n\n    _init() {\n        this._listarTodos();\n        setInterval(() => this.importarNegociacoes(), 5000);\n    }\n\n\n    apagar() {\n\n        new NegociacaoService()\n            .apagar()\n            .then(mensagem => {\n                this._mensagem.texto = mensagem;\n                this._listaNegociacoes.removerTodosRegistros();\n                this._limparCamposForm();\n            })\n            .catch(erroMsg => this._mensagem.texto = erroMsg);\n    }\n\n\n    adiciona(event) {\n\n        event.preventDefault();\n\n        let negociacao = this._criaNegociacao();\n        new NegociacaoService().cadastrar(negociacao)\n            .then(msg => {\n                this._listaNegociacoes.adiciona(negociacao);\n                this._mensagem.texto = msg;\n                this._limparCamposForm();\n\n            }).catch(erro => this._mensagem.texto = erro);\n    }\n\n    _listarTodos() {\n\n        new NegociacaoService()\n            .listar()\n            .then(negociacoes => this._listaNegociacoes.adicionarTodos(negociacoes))\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n\n    _criaNegociacao() {\n        return new Negociacao(\n            DateHelper.textToDate(this._inputData.value),\n            parseInt(this._inputQuantidade.value),\n            parseFloat(this._inputvalor.value));\n    }\n\n    _limparCamposForm() {\n        this._inputData.value = '';\n        this._inputQuantidade.value = '1';\n        this._inputvalor.value = '0.00';\n        this._inputData.focus();\n    }\n\n    importarNegociacoes() {\n\n        let service = new NegociacaoService();\n        service\n            .importar(this._listaNegociacoes.negociacoes)\n            .then(negociacoes => negociacoes.forEach(negociacao => {\n                this._listaNegociacoes.adiciona(negociacao);\n                this._mensagem.texto = \"Negociações importadas com sucesso\";\n            }))\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n    ordena(coluna) {\n        if (this._ordemAtual == coluna) {\n            this._listaNegociacoes.inverteOrdem();\n        } else {\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n        }\n        this._ordemAtual = coluna;\n    }\n}\n\nlet current = new NegociacaoController();\nexport function currentInstance() {\n    return current;\n}"]}